"use strict";!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof module&&module.exports?module.exports=e():t.kappa=e()}(this,function t(){var e={__name__:"kappa",__init__:t,__dependencies__:{},__version__:"0.0.1",utils:{},data:{},lexer:{},parser:{}};e.utils.obj=function(){var t=function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},e=function(t,e,i){if(!t||!e)throw new Error("Invalid property specification. In order to create a property please specify a context and a property name.");var r=n({enumerable:!0,configurable:!1,set:function(n){t.options[e]=n},get:function(){return t.options[e]}},i||{});Object.defineProperty(t,e,r)},n=function(t){for(var e=Array.prototype.slice.call(arguments,1),n=0;n<e.length;n++)if(e[n])for(var i in e[n])t[i]=e[n][i];return t},i=function(t){return JSON.parse(JSON.stringify(t))},r=function(t){for(var e=Array.prototype.slice.call(arguments,1),n=i(t),r=0;r<e.length;r++)if(e[r])for(var a in e[r])n[a]=e[r][a];return n},a=function(t){return"[object Array]"===Object.prototype.toString.call(t)},o=function(t){return"[object String]"===Object.prototype.toString.call(t)},s=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},u=function(t){return"[object Number]"===Object.prototype.toString.call(t)},l=function(t){return"[object Function]"===Object.prototype.toString.call(t)},c=function(t){return t===!0||t===!1||"[object Boolean]"===Object.prototype.toString.call(t)},d=function(t){return"[object Arguments]"===Object.prototype.toString.call(t)};d(arguments)||(d=function(t){return!(!t||!_(t,"callee"))});var m=function(t){return t===Object(t)&&!l(t)},h=function(t){return void 0===t},p={},f=Array.prototype,y=f.concat,b=f.push,g=Function.prototype,S=Object.keys,R=f.forEach,E=f.reduce,v=g.bind,T=f.filter,j=f.some,w=f.every,I=f.indexOf,A=f.slice,_=function(t,e){return hasOwnProperty.call(t,e)},P=function(t){if(!m(t))return[];if(S)return S(t);var e=[];for(var n in t)_(t,n)&&e.push(n);return e},N=function(t,e,n){if(null===t)return t;var i,r;if(R&&t.forEach===R)t.forEach(e,n);else if(t.length===+t.length){for(i=0,r=t.length;r>i;i++)if(e.call(n,t[i],i,t)===p)return}else{var a=P(t);for(i=0,r=a.length;r>i;i++)if(e.call(n,t[a[i]],a[i],t)===p)return}return t},L=function(t,e,n){var i=[];return null===t?i:(N(t,function(t,r,a){i.push(e.call(n,t,r,a))}),i)},O="Reduce of empty array with no initial value",F=function(t,e,n,i){var r=arguments.length>2;if(null===t&&(t=[]),E&&t.reduce===E)return i&&(e=x(e,i)),r?t.reduce(e,n):t.reduce(e);if(N(t,function(t,a,o){r?n=e.call(i,n,t,a,o):(n=t,r=!0)}),!r)throw new TypeError(O);return n},U=function(){},x=function(t,e){var n,i;if(v&&t.bind===v)return v.apply(t,A.call(arguments,1));if(!l(t))throw new TypeError;return n=A.call(arguments,2),i=function(){if(!(this instanceof i))return t.apply(e,n.concat(A.call(arguments)));U.prototype=t.prototype;var r=new U;U.prototype=null;var a=t.apply(r,n.concat(A.call(arguments)));return Object(a)===a?a:r}},C=function(t,e,n){var i=[];return null===t?i:T&&t.filter===T?t.filter(e,n):(N(t,function(t,r,a){e.call(n,t,r,a)&&i.push(t)}),i)},k=function(t){return t},D=function(t,e,n){e=e||k;var i=!1;return null===t?i:j&&t.some===j?t.some(e,n):(N(t,function(t,r,a){return i||(i=e.call(n,t,r,a))?p:void 0}),!!i)},B=function(t,e){return L(t,H(e))},H=function(t){return function(e){return e[t]}},G=function(t){return null===t||void 0===t?k:l(t)?t:H(t)},V=function(t,e,n){return e=G(e),B(L(t,function(t,i,r){return{value:t,index:i,criteria:e.call(n,t,i,r)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return t.index-e.index}),"value")},M=function(t,e,n){var i;return D(t,function(t,r,a){return e.call(n,t,r,a)?(i=t,!0):void 0}),i},Y=function(t){return function(e,n,i){var r={};return n=G(n),N(e,function(a,o){var s=n.call(i,a,o,e);t(r,s,a)}),r}},q=function(t,e,n){e=e||k;var i=!0;return null===t?i:w&&t.every===w?t.every(e,n):(N(t,function(t,r,a){return(i=i&&e.call(n,t,r,a))?void 0:p}),!!i)},X=function(t,e,n){return e&&q(t,a)?y.apply(n,t):(N(t,function(t){a(t)||d(t)?e?b.apply(n,t):X(t,e,n):n.push(t)}),n)},Q=function(t,e){return X(t,e,[])},z=function(t,e){return null===t?!1:I&&t.indexOf===I?-1!==t.indexOf(e):D(t,function(t){return t===e})},$=function(t,e,n,i){l(e)&&(i=n,n=e,e=!1);var r=n?L(t,n,i):t,a=[],o=[];return N(r,function(n,i){(e?i&&o[o.length-1]===n:z(o,n))||(o.push(n),a.push(t[i]))}),a},J=Y(function(t,e,n){_(t,e)?t[e].push(n):t[e]=[n]}),W=function(t,e,n,i){n=G(n);for(var r=n.call(i,e),a=0,o=t.length;o>a;){var s=a+o>>>1;n.call(i,t[s])<r?a=s+1:o=s}return a},Z=function(t,e,n){if(null===t)return-1;var i=0,r=t.length;if(n){if("number"!=typeof n)return i=W(t,e),t[i]===e?i:-1;i=0>n?Math.max(0,r+n):n}if(I&&t.indexOf===I)return t.indexOf(e,n);for(;r>i;i++)if(t[i]===e)return i;return-1},K=0,te=function(t){var e=++K+"";return t?t+e:e},ee=function(t,e,n){return null===t||void 0===t?void 0:null===e||void 0===e||n?t[t.length-1]:A.call(t,Math.max(t.length-e,0))};return{inherit:t,extend:n,extendInNew:r,clone:i,isArray:a,isString:o,isRegExp:s,isNumber:u,isObject:m,isFunction:l,isArguments:d,isBoolean:c,isUndefined:h,keys:P,each:N,map:L,has:_,reduce:F,bind:x,filter:C,any:D,defineProperty:e,pluck:B,sortBy:V,property:H,find:M,every:q,flatten:Q,groupBy:J,contains:z,uniq:$,sortedIndex:W,indexOf:Z,uniqueId:te,last:ee}}(),e.utils.str=function(){var t=function(t,e){return t?String.prototype.slice.call(t,0,e.length)===e:!1},e=function(t){return t.replace(/^\s+|\s+$/g,"")},n=function(t){return t.replace(/^\s+/,"")},i=function(t){return t.replace(/\s+$/,"")},r=function(t){return t.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,"").replace(/\s+/g," ")},a=function(t){for(var e="",n=t;n--;)e+="	";return e};return{startsWith:t,trim:e,ltrim:n,rtrim:i,fulltrim:r,tabs:a}}(),e.data.Node=function(){var t=function(t){this.options=t,e.utils.obj.defineProperty(this,"transitions"),e.utils.obj.defineProperty(this,"nodes"),e.utils.obj.defineProperty(this,"name"),e.utils.obj.defineProperty(this,"_id"),this.transitions=t.transitions||[],this.nodes=t.nodes||[]};return t.prototype.getIdentity=function(){return this._id||(this._id=this._generateIdentity()),this._id},t.prototype._generateIdentity=function(){return this.name||e.utils.obj.uniqueId("node_")},t.prototype.addTransition=function(t,e){this.transitions.push(this._generateNewTransition(t,e)),this.nodes.push(e)},t.prototype._generateNewTransition=function(t,e){return{transitionValue:t,node:e}},t.prototype.toString=function(){return this.getIdentity()},t}();{var n=e.data.specialSymbol={EMPTY:"EMPTY",EOF:"EOF"},i=(e.data.associativity={LEFT:"LEFT",RIGHT:"RIGHT"},e.data.Symbol=function(){var t=function(t){if(this.options=t,e.utils.obj.defineProperty(this,"name"),e.utils.obj.defineProperty(this,"isSpecial"),e.utils.obj.defineProperty(this,"rule"),this.isSpecial=e.utils.obj.isBoolean(t.isSpecial)?t.isSpecial:!0,!this.name||!e.utils.obj.isString(this.name))throw new Error("Invalid initialization values for a symbol, please provide a string name a symbol")};return t.prototype.toString=function(){return this.name.toString()},t}()),r=e.data.NonTerminal=function(t){function n(){t.apply(this,arguments),e.utils.obj.defineProperty(this,"isNullable"),this.isNullable=!1,this.isSpecial=!1}return e.utils.obj.inherit(n,t),n.fromArray=function(t){if(!e.utils.obj.isArray(t)&&!e.utils.obj.isString(t))throw new Error("Invalid parameter. To create non terminal from array the input parameter should be an array!");var n=[];return e.utils.obj.each(t,function(t){n[n.length]=new r({name:t})}),n},n}(i),a=e.data.Terminal=function(t){function n(n){if(!e.utils.obj.isString(n.body)&&!e.utils.obj.isRegExp(n.body))throw new Error("Invalid Terminal Initialization. A string or regexp body must be specified");n.name=n.name?n.name:n.body.toString(),t.apply(this,arguments),e.utils.obj.defineProperty(this,"body"),e.utils.obj.defineProperty(this,"isTerminal"),e.utils.obj.defineProperty(this,"assoc"),this.isSpecial=!1,this.isTerminal=!0}return e.utils.obj.inherit(n,t),n.prototype.toString=function(){return"<"+this.name+">"},n}(i),o=e.data.Rule=function(){var t=function(t){if(this.options=t,!t.head)throw new Error("Invalid initialization values, please provide a head for the rule");e.utils.obj.defineProperty(this,"head"),e.utils.obj.defineProperty(this,"tail"),e.utils.obj.defineProperty(this,"reduceFunc"),e.utils.obj.defineProperty(this,"name"),e.utils.obj.defineProperty(this,"precendence"),e.utils.obj.defineProperty(this,"index"),e.utils.obj.defineProperty(this,"isProductive"),e.utils.obj.defineProperty(this,"isReachable"),e.utils.obj.defineProperty(this,"terminalsCount"),this.index=-1,this.isProductive=!1,this.isReachable=!1,this.terminalsCount=0,this.head=t.head instanceof r?t.head:new r({name:t.head.toString()}),this.tail=t.tail&&e.utils.obj.isArray(t.tail)?t.tail:[new i({name:n.EMPTY,isSpecial:!0})],e.utils.obj.each(this.tail,function(t){t instanceof a&&this.terminalsCount++,t.rule=this},this)};return t.prototype.toString=function(){return this.head.toString()+" --> "+this.tail.join(" ")},t}();e.data.Grammar=function(){var t={name:""},s=function(n){if(this.options=e.utils.obj.extendInNew(t,n||{}),e.utils.obj.defineProperty(this,"startSymbol"),e.utils.obj.defineProperty(this,"name"),e.utils.obj.defineProperty(this,"rules"),e.utils.obj.defineProperty(this,"preserveNonProductiveRules"),e.utils.obj.defineProperty(this,"preserveUnReachableRules"),e.utils.obj.defineProperty(this,"specifiedStartSymbol"),e.utils.obj.defineProperty(this,"terminals"),e.utils.obj.defineProperty(this,"rulesByHeader"),e.utils.obj.defineProperty(this,"firstSetsByHeader"),e.utils.obj.defineProperty(this,"nullableNonTerminals"),!(this.startSymbol instanceof i))throw new Error("Invalid grammar creation, please specify a start Symbol!");this.nullableNonTerminals=[],this._generateRequireRequisites()};return s.constants={AugmentedRuleName:"AUGMENTRULE"},s.prototype._isRuleProductive=function(t){return!e.utils.obj.find(t.tail,function(t){return t instanceof r&&(this.rulesByHeader[t.name]&&e.utils.obj.every(this.rulesByHeader[t.name],function(t){return!t.isProductive})||!this.rulesByHeader[t.name])?!0:!1},this)},s.prototype._generateRequireRequisites=function(){var t=this._augmentGrammar(this.startSymbol,this.startSymbol);e.utils.obj.each(this.rules,function(t,e){t.index=e}),this._indexRulesByHead(),t=this._cleanUnProductiveRules()||t,this._indexRulesByHead(),this._cleanUnReachableRules(t),this._indexRulesByHead(),this._removeMiddleTailEpsilons(),this._determineNullableNonTerminals(),this.terminals=this._generateListOfTerminals(),this.firstSetsByHeader=this._precalculateFirstTerminals()},s.prototype._indexRulesByHead=function(){this.rulesByHeader=e.utils.obj.groupBy(this.rules,function(t){return t.head.name})},s.prototype._precalculateFirstTerminals=function(){var t={};return e.utils.obj.each(e.utils.obj.keys(this.rulesByHeader),function(e){t[e]=this._calculateFirstSetForHead(e)},this),t},s.prototype._calculateFirstSetForHead=function(t,i){var o=[];return i=i||{},e.utils.obj.each(this.rulesByHeader[t],function(t){e.utils.obj.find(t.tail,function(t){if(t instanceof r){if(i[t.name])return!t.isNullable;i[t.name]=!0}else if(t.isSpecial&&t.name===n.EOF)return!0;if(t instanceof a||t.name===n.EMPTY&&t.isSpecial)o.push(t);else{if(!(t instanceof r))throw new Error("Impossible to calculate FIRST Set, some rules have invalid tail symbols");o=o.concat(e.utils.obj.flatten(this._calculateFirstSetForHead(t.name,i),!0))}return!e.utils.obj.find(o,function(t){return t.name===n.EMPTY})},this)},this),e.utils.obj.uniq(o,!1,function(t){return t.name})},s.prototype._augmentGrammar=function(t,i){this.specifiedStartSymbol=i;var r=new o({head:"S'",tail:[t,new e.data.Symbol({name:n.EOF,isSpecial:!0})],name:s.constants.AugmentedRuleName});return this.rules.unshift(r),this.startSymbol=r.head,r},s.prototype._cleanUnProductiveRules=function(){var t,i=!1,r=0;do i=!1,e.utils.obj.each(this.rules,function(t){t.isProductive||(t.isProductive=this._isRuleProductive(t),i=i||t.isProductive)},this);while(i);if(!this.preserveNonProductiveRules){for(;r<this.rules.length;)this.rules[r].isProductive?r++:this.rules.splice(r,1);0===this.rules.length&&(t=this._augmentGrammar(new e.data.Symbol({name:n.EMPTY,isSpecial:!0}),this.specifiedStartSymbol),t.index=0)}return t},s.prototype._removeMiddleTailEpsilons=function(){var t=0;e.utils.obj.each(this.rules,function(i){for(t=0;t<i.tail.length;)i.tail[t].isSpecial&&i.tail[t].name===e.data.specialSymbol.EMPTY&&(t+1<i.tail.length&&(!i.tail[t+1].isSpecial||i.tail[t+1].name!==n.EOF)||t===i.tail.length-1&&t>0&&!i.tail[t-1].isSpecial)&&(i.tail.splice(t,1),--t),t++})},s.prototype._cleanUnReachableRules=function(t){var n=!1,i=0;t.isReachable=!0;do n=!1,e.utils.obj.each(this.rules,function(t){t.isReachable&&e.utils.obj.each(t.tail,function(t){t instanceof r&&e.utils.obj.each(this.rulesByHeader[t.name],function(t){t.isReachable||(n=!0,t.isReachable=!0)})},this)},this);while(n);if(!this.preserveUnReachableRules)for(i=0;i<this.rules.length;)this.rules[i].isReachable?i++:this.rules.splice(i,1)},s.prototype._generateListOfTerminals=function(){var t=e.utils.obj.flatten(e.utils.obj.map(this.rules,function(t){return t.tail}),!1);return e.utils.obj.filter(e.utils.obj.uniq(t,!1,function(t){return t.name}),function(t){return t.isTerminal})},s.prototype._determineNullableNonTerminals=function(){var t=!1,n=!1;do n=!1,e.utils.obj.each(this.rules,function(i){1!==i.tail.length||i.tail[0].name!==e.data.specialSymbol.EMPTY||i.head.isNullable?0===i.terminalsCount&&(t=e.utils.obj.every(i.tail,function(t){return this.nullableNonTerminals.indexOf(t.name)>=0},this),t&&!i.head.isNullable&&(i.head.isNullable=!0,n=!0,this.nullableNonTerminals.push(i.head.name))):(i.head.isNullable=!0,n=!0,this.nullableNonTerminals.push(i.head.name))},this);while(n);var i=e.utils.obj.flatten(e.utils.obj.map(this.rules,function(t){return t.tail.concat(t.head)}),!1),a=e.utils.obj.filter(i,function(t){return t instanceof r&&this.nullableNonTerminals.indexOf(t.name)>=0},this);e.utils.obj.each(a,function(t){t.isNullable=!0})},s.prototype.getRulesFromNonTerminal=function(t){return this.rulesByHeader[t.name]},s.prototype.toString=function(){var t=this.name?"Name: "+this.name+"\n":"";return t+="Start Symbol: "+this.startSymbol.name+"\n",t+=e.utils.obj.reduce(e.utils.obj.sortBy(this.rules,function(t){return t.index}),function(t,e){return t+"\n"+e.index+". "+e.toString()},"")},s}()}e.data.ASTNode=function(t){function n(){t.apply(this,arguments),e.utils.obj.defineProperty(this,"rule"),e.utils.obj.defineProperty(this,"stringValue"),e.utils.obj.defineProperty(this,"currentValue"),e.utils.obj.defineProperty(this,"symbol")}return e.utils.obj.inherit(n,t),n.prototype.toString=function(t){if(t&&!e.utils.obj.isUndefined(t.deep)){t.deep=e.utils.obj.isNumber(t.deep)?t.deep:0;var n=e.utils.str.tabs(t.deep);return++t.deep,n+this._toCurrentString()+"\n"+e.utils.obj.reduce(this.nodes,function(n,i){return n+(e.utils.obj.isString(i)?e.utils.str.tabs(t.deep)+i+"\n":i.toString({deep:t.deep}))},"")}return this._toCurrentString()},n.prototype._toCurrentString=function(){return this.getIdentity()+(this.rule?": "+this.rule.toString()+" ("+this.currentValue+")":"")},n}(e.data.Node);var s=e.data.ItemRule=function(){var t={dotLocationIncrement:0},n=function(t){this.options=t,e.utils.obj.defineProperty(this,"rule"),e.utils.obj.defineProperty(this,"dotLocation"),e.utils.obj.defineProperty(this,"lookAhead"),e.utils.obj.defineProperty(this,"_id"),this.lookAhead=this.lookAhead||[],this.dotLocation=t.dotLocation||0,this.rule&&1===this.rule.tail.length&&this.rule.tail[0].name===e.data.specialSymbol.EMPTY&&(this.dotLocation=1)};return n.prototype.toString=function(){for(var t=this.getIdentity()+".  "+this.rule.head.name+"-->",e=0;e<this.rule.tail.length;e++)t+=(this.dotLocation===e?"*":" ")+this.rule.tail[e].toString();return this.dotLocation===e&&(t+="*"),t+=",    ["+this.lookAhead.join(", ")+"]"},n.prototype.clone=function(n,i){var r=e.utils.obj.extendInNew(t,n||{}),a=this._cloneCurrentOptions(n,i),o=new s(a);return o._incrementDotLocation(r.dotLocationIncrement),o._id=null,o},n.prototype._cloneCurrentOptions=function(t,n){var i=this.rule,r=this.lookAhead;this.rule=this.lookAhead=null;var a=e.utils.obj.extendInNew(this.options,n||{});return this.rule=a.rule=i,this.lookAhead=r,a.lookAhead=[].concat(r),a},n.prototype._incrementDotLocation=function(t){var n=e.utils.obj.isNumber(this.options.dotLocation)?this.options.dotLocation:0,i=e.utils.obj.isNumber(t)?t:1;this.dotLocation=n+i},n.prototype.getIdentity=function(){return this._id||(this._id=this._generateIdentity()),this._id},n.prototype._generateIdentity=function(){return this.rule.index+"("+this.dotLocation+")"},n.prototype.getCurrentSymbol=function(){return this.dotLocation<this.rule.tail.length+1?this.rule.tail[this.dotLocation]:null},n.prototype.isReduce=function(){return this.dotLocation===this.rule.tail.length},n.newFromRules=function(t,n){return e.utils.obj.reduce(t,function(t,e){return t.push(new s({rule:e,dotLocation:0,lookAhead:[].concat(n||[])})),t},[])},n}();e.data.sampleGrammars={numDivs:function(){var t=new e.data.Rule({head:"S",tail:e.data.NonTerminal.fromArray(["E"]),name:"SRULE"}),n=new e.data.Rule({head:"E",tail:e.data.NonTerminal.fromArray(["E","Q","F"]),name:"E1RULE"}),i=new e.data.Rule({head:"E",tail:e.data.NonTerminal.fromArray(["F"]),name:"E2RULE"}),r=new e.data.Rule({head:"Q",tail:[new e.data.Terminal({name:"DIV",body:/\//})],name:"QRULE"}),a=new e.data.Rule({head:"F",tail:[new e.data.Terminal({name:"NUMBER",body:/\d/})],name:"FRULE"});return{g:new e.data.Grammar({startSymbol:t.head,rules:[t,n,i,r,a],name:"numDivs"}),S:t,E1:n,E2:i,Q:r,F:a}}(),idsList:function(){var t=new e.data.Rule({head:"S",tail:e.data.NonTerminal.fromArray(["OPAREN","EXPS","CPAREN"]),name:"SRULE"}),n=new e.data.Rule({head:"EXPS",tail:e.data.NonTerminal.fromArray(["EXPS","EXP"]),name:"EXPS1RULE"}),i=new e.data.Rule({head:"EXPS",name:"EXPS2RULE"}),r=new e.data.Rule({head:"EXP",tail:[new e.data.Terminal({name:"id_terminal",body:/[a-zA-Z]+/})],name:"EXPRULE"}),a=new e.data.Rule({head:"OPAREN",tail:[new e.data.Terminal({name:"oparen_terminal",body:/\(/})],name:"OPARENRULE"}),o=new e.data.Rule({head:"CPAREN",tail:[new e.data.Terminal({name:"cparen_terminal",body:/\)/})],name:"CPARENRULE"});return{g:new e.data.Grammar({startSymbol:t.head,rules:[t,n,i,r,a,o],name:"idsList"}),S:t,EXPS1:n,EXPS2:i,EXP:r,OPAREN:a,CPAREN:o}}(),numDivsEmpty:function(){var t=new e.data.Rule({head:"S",tail:e.data.NonTerminal.fromArray(["E"]),name:"SRULE"}),n=new e.data.Rule({head:"E",tail:e.data.NonTerminal.fromArray(["E","Q","F"]),name:"E1RULE"}),i=new e.data.Rule({head:"E",tail:e.data.NonTerminal.fromArray(["F"]),name:"E2RULE"}),r=new e.data.Rule({head:"Q",tail:[new e.data.Terminal({name:"DIV",body:/\//})],name:"Q1RULE"}),a=new e.data.Rule({head:"Q",name:"Q2RULE"}),o=new e.data.Rule({head:"F",tail:[new e.data.Terminal({name:"NUMBER",body:/\d/})],name:"FRULE"});return{g:new e.data.Grammar({startSymbol:t.head,rules:[t,n,i,r,a,o],name:"numDivsEmpty"}),S:t,E1:n,E2:i,Q1:r,Q2:a,F:o}}(),numDiff:function(){var t=new e.data.Rule({head:"S",tail:e.data.NonTerminal.fromArray(["E"]),name:"SRULE"}),n=new e.data.Rule({head:"E",tail:e.data.NonTerminal.fromArray(["E","R","T"]),name:"E1RULE"}),i=new e.data.Rule({head:"E",tail:e.data.NonTerminal.fromArray(["T"]),name:"E2RULE"}),r=new e.data.Rule({head:"T",tail:[new e.data.Terminal({name:"NUMBER",body:/\d/})],name:"T1RULE"}),a=new e.data.Rule({head:"T",tail:e.data.NonTerminal.fromArray(["OPAREN","E","CPAREN"]),name:"T2RULE"}),o=new e.data.Rule({head:"OPAREN",tail:[new e.data.Terminal({name:"OPAREN",body:/\(/})],name:"OPARENRULE"}),s=new e.data.Rule({head:"CPAREN",tail:[new e.data.Terminal({name:"CPAREN",body:/\)/})],name:"CPARENRULE"}),u=new e.data.Rule({head:"R",tail:[new e.data.Terminal({name:"DIFF",body:"-"})],name:"RRULE"});return{g:new e.data.Grammar({startSymbol:t.head,rules:[t,n,i,r,a,o,s,u],name:"numDiff"}),S:t,E1:n,E2:i,T1:r,T2:a,OPAREN:o,CPAREN:s,R:u}}(),aPlusb:function(){var t=new e.data.Rule({head:"A",tail:[new e.data.Terminal({name:"A_LET",body:"a"}),new e.data.NonTerminal({name:"A"})],name:"A1RULE"}),n=new e.data.Rule({head:"A",tail:[new e.data.Terminal({name:"B_LET",body:"b"})],name:"A2RULE"});return{g:new e.data.Grammar({startSymbol:t.head,rules:[t,n],name:"aPlusb"}),A1:t,A2:n}}(),aPlusEMPTY:function(){var t=new e.data.Rule({head:"S",tail:[new e.data.Terminal({name:"A_LET",body:"a"}),new e.data.NonTerminal({name:"S"})],name:"S1RULE"}),n=new e.data.Rule({head:"S",tail:[new e.data.Symbol({name:e.data.specialSymbol.EMPTY})],name:"S2RULE"});return{g:new e.data.Grammar({startSymbol:t.head,rules:[t,n],name:"aPlusEMPTY"}),S1:t,S2:n}}(),numDiffCondenced:function(){var t=new e.data.Rule({head:"S",tail:e.data.NonTerminal.fromArray(["E"]),name:"SRULE"}),n=new e.data.Rule({head:"E",tail:[new e.data.NonTerminal({name:"E"}),new e.data.Terminal({name:"DIFF",body:"-"}),new e.data.NonTerminal({name:"T"})],name:"E1RULE"}),i=new e.data.Rule({head:"E",tail:e.data.NonTerminal.fromArray(["T"]),name:"E2RULE"}),r=new e.data.Rule({head:"T",tail:[new e.data.Terminal({name:"NUMBER",body:/\d/})],name:"T1RULE"}),a=new e.data.Rule({head:"T",tail:[new e.data.Terminal({name:"OPAREN",body:/\(/}),new e.data.NonTerminal({name:"E"}),new e.data.Terminal({name:"CPAREN",body:/\)/})],name:"T2RULE"});return{g:new e.data.Grammar({startSymbol:t.head,rules:[t,n,i,r,a],name:"numDiffCondenced"}),S:t,E1:n,E2:i,T1:r,T2:a}}(),aPowN1b:function(){var t=new e.data.Rule({head:"S",tail:e.data.NonTerminal.fromArray(["A","D"]),name:"SRULE"}),n=new e.data.Rule({head:"A",tail:[new e.data.Terminal({name:"a_terminal",body:"a"}),new e.data.NonTerminal({name:"A"}),new e.data.Terminal({name:"b_terminal",body:"b"})],name:"A1RULE"}),i=new e.data.Rule({head:"A",tail:[new e.data.Terminal({name:"a_terminal",body:"a"})],name:"A2RULE"}),r=new e.data.Rule({head:"D",tail:[new e.data.Terminal({name:"d_terminal",body:"d"})],name:"DRULE"});return{g:new e.data.Grammar({startSymbol:t.head,rules:[t,n,i,r],name:"aPowN1b"}),S:t,A1:n,A2:i,D:r}}(),selectedBs:function(){var t=new e.data.Rule({head:"S",tail:[new e.data.Terminal({name:"b_terminal",body:"b"})],name:"S1RULE"}),n=new e.data.Rule({head:"S",tail:[new e.data.Terminal({name:"oparen_terminal",body:"("}),new e.data.NonTerminal({name:"L"}),new e.data.Terminal({name:"cparen_terminal",body:")"})],name:"S2RULE"}),i=new e.data.Rule({head:"L",tail:[new e.data.NonTerminal({name:"S"})],name:"L1RULE"}),r=new e.data.Rule({head:"L",tail:[new e.data.NonTerminal({name:"L"}),new e.data.Terminal({name:"semicol_terminal",body:";"}),new e.data.NonTerminal({name:"S"})],name:"L2RULE"});return{g:new e.data.Grammar({startSymbol:t.head,rules:[t,n,i,r],name:"selectedBs"}),S1:t,S2:n,L1:i,L2:r}}(),arithmetic:function(){var t=new e.data.NonTerminal({name:"E"}),n=new e.data.Terminal({name:"plus_terminal",body:"+",assoc:e.data.associativity.LEFT}),i=new e.data.Terminal({name:"minus_terminal",body:"-",assoc:e.data.associativity.LEFT}),r=new e.data.Terminal({name:"multi_terminal",body:"*",assoc:e.data.associativity.LEFT}),a=new e.data.Terminal({name:"div_terminal",body:"/",assoc:e.data.associativity.LEFT}),o=new e.data.Terminal({name:"oparen_terminal",body:"("}),s=new e.data.Terminal({name:"cparen_terminal",body:")"}),u=new e.data.Terminal({name:"number_terminal",body:/\d+/}),l=new e.data.Rule({head:t.name,tail:[t,n,t],reduceFunc:function(t){return t.values[0]+t.values[2]},precendence:10,name:"EPLUSRULE"}),c=new e.data.Rule({head:t.name,tail:[t,i,t],reduceFunc:function(t){return t.values[0]-t.values[2]},precendence:10,name:"EMINUSRULE"}),d=new e.data.Rule({head:t.name,tail:[t,r,t],reduceFunc:function(t){return t.values[0]*t.values[2]},precendence:20,name:"EMULTIRULE"}),m=new e.data.Rule({head:t.name,tail:[t,a,t],reduceFunc:function(t){return t.values[0]/t.values[2]},precendence:20,name:"EDIVRULE"}),h=new e.data.Rule({head:t.name,tail:[o,t,s],reduceFunc:function(t){return t.values[1]},precendence:30,name:"EPARENRULE"}),p=new e.data.Rule({head:t.name,tail:[u],reduceFunc:function(t){return parseInt(t.values[0])},name:"ENUMBERRULE"});return{g:new e.data.Grammar({startSymbol:l.head,rules:[l,c,d,m,h,p],name:"arithmetic"}),plus_T:n,minus_T:i,multi_T:r,div_T:a,number_T:u,E1:l,E2:c,E3:d,E4:m,E5:h,EN:p}}()},e.data.StackItem=function(){var t=function(t){if(this.options=t,e.utils.obj.defineProperty(this,"state"),e.utils.obj.defineProperty(this,"currentValue"),e.utils.obj.defineProperty(this,"stringValue"),e.utils.obj.defineProperty(this,"symbol"),e.utils.obj.defineProperty(this,"AST"),!this.state)throw new Error("Invalid initialization values for a Stack Item, please provide a valid state")};return t}(),e.data.State=function(t){function n(n){t.apply(this,arguments),e.utils.obj.defineProperty(this,"isAcceptanceState"),e.utils.obj.defineProperty(this,"_items"),e.utils.obj.defineProperty(this,"_registerItems"),e.utils.obj.defineProperty(this,"_index"),e.utils.obj.defineProperty(this,"_condencedView"),this.isAcceptanceState=!1,this._items=n.items||[],n.items=null,this._index=0,this._registerItems={},this._registerItemRules()}return e.utils.obj.inherit(n,t),n.prototype._registerItemRules=function(){e.utils.obj.each(this._items,function(t){this._registerItems[t.getIdentity()]=t},this)},n.constants={AcceptanceStateName:"AcceptanceState"},n.prototype.getNextItem=function(){return this._index<this._items.length?this._items[this._index++]:null},n.prototype.addItems=function(t,n){this._id=null,e.utils.obj.each(t,function(t){if(this._registerItems[t.getIdentity()]){if(n&&n.hasLookAhead){var i=this._registerItems[t.getIdentity()].lookAhead.concat(t.lookAhead);this._registerItems[t.getIdentity()].lookAhead=e.utils.obj.uniq(i,function(t){return t.name})}}else this._registerItems[t.getIdentity()]=t,this._items.push(t)},this)},n.prototype.toString=function(){var t="ID: "+this.getIdentity()+"\n"+this._items.join("\n")+"\nTRANSITIONS:\n";return e.utils.obj.each(this.transitions,function(e){t+="*--"+e.symbol+"-->"+e.state.getIdentity()+"\n"}),t},n.prototype.getCondencedString=function(){return this._condencedView||(this._condencedView=this._generateCondencedString()),this._condencedView},n.prototype._generateCondencedString=function(){return e.utils.obj.map(e.utils.obj.sortBy(this._items,function(t){return t.rule.index}),function(t){return t.rule.index}).join("-")},n.prototype._generateIdentity=function(){return this.isAcceptanceState?n.constants.AcceptanceStateName:this._items.length?e.utils.obj.reduce(e.utils.obj.sortBy(this._items,function(t){return t.rule.index}),function(t,e){return t+e.getIdentity()},""):t.prototype._generateIdentity.apply(this,arguments)},n.prototype.getItems=function(){return e.utils.obj.map(this._items,function(t){return t.clone()})},n.prototype.getOriginalItems=function(){return this._items},n.prototype.getOriginalItemById=function(t){return this._registerItems[t]},n.prototype.getSupportedTransitionSymbols=function(){var t,n={},i=[];return e.utils.obj.each(this._items,function(e){t=e.getCurrentSymbol(),t&&(n[t.name]?n[t.name].push(e):(n[t.name]=[e],i.push({symbol:t,items:n[t.name]})))}),i},n.prototype._generateNewTransition=function(t,e){return{symbol:t,state:e}},n.prototype.getRecudeItems=function(){return e.utils.obj.filter(this._items,function(t){return t.isReduce()})},n}(e.data.Node),e.data.Automata=function(){var t=function(t){this.options=t,e.utils.obj.defineProperty(this,"states"),e.utils.obj.defineProperty(this,"initialState"),e.utils.obj.defineProperty(this,"hasLookAhead"),e.utils.obj.defineProperty(this,"_index"),e.utils.obj.defineProperty(this,"_unprocessedStates"),e.utils.obj.defineProperty(this,"_registerStates"),this.states=t.states||[],this._unprocessedStates=[],this._index=0,this._registerStates=e.utils.obj.groupBy(this.states,function(t){return t.getIdentity()}),this.states.length&&(this._unprocessedStates=[].concat(this.states))};return t.prototype.toString=function(){return this.states.join("\n")},t.prototype.getNextState=function(){return this._unprocessedStates.splice(0,1)[0]},t.prototype.initialStateAccessor=function(t){return t?void(this.initialState=t):this.initialState},t.prototype.addState=function(t){if(this._registerStates[t.getIdentity()]){if(this.hasLookAhead){var n=this._registerStates[t.getIdentity()],i=!1;if(e.utils.obj.each(n.getOriginalItems(),function(n){var r=t.getOriginalItemById(n.getIdentity()),a=n.lookAhead.length;n.lookAhead=e.utils.obj.uniq(n.lookAhead.concat(r.lookAhead),function(t){return t.name}),i||a===n.lookAhead.length||(i=!0)}),i){var r=e.utils.obj.find(this._unprocessedStates,function(t){return n.getIdentity()===t.getIdentity()});r||this._unprocessedStates.push(n)}}}else this._registerStates[t.getIdentity()]=t,this.states.push(t),this._unprocessedStates.push(t);return this._registerStates[t.getIdentity()]},t}(),e.lexer.Lexer=function(){var t={notIgnoreSpaces:!1},n=function(n){this.options=e.utils.obj.extendInNew(t,n||{}),e.utils.obj.defineProperty(this,"grammar"),e.utils.obj.defineProperty(this,"stream"),e.utils.obj.defineProperty(this,"inputStream"),e.utils.obj.defineProperty(this,"notIgnoreSpaces"),this.setStream(this.stream)};return n.prototype.setStream=function(t){this.stream=t,this.inputStream=!this.notIgnoreSpaces&&this.stream?e.utils.str.ltrim(this.stream):this.stream,this.notIgnoreSpaces||""!==this.inputStream||(this.inputStream=null)},n.prototype._getErrorResult=function(){return{length:-1,string:this.inputStream,ERROR:"NOT MATCHING FOUND"}},n.prototype.getNext=function(){var t,n={length:-1},i=this.grammar.terminals,r=e.utils.obj.find(this.grammar.rules,function(t){return 1===t.tail.length&&t.tail[0].isSpecial&&t.tail[0].name===e.data.specialSymbol.EMPTY});if(null===this.inputStream)n={length:-1,terminal:new e.data.Symbol({name:e.data.specialSymbol.EOF})};else if(""===this.inputStream)r?(n={length:0,string:"",terminal:new e.data.Symbol({name:e.data.specialSymbol.EMPTY})},this.inputStream=null):n=this._getErrorResult();else{for(var a=0;a<i.length;a++)if(t=i[a].body,t instanceof RegExp&&!this.inputStream.search(t)){var o=t.exec(this.inputStream)[0];n.length<o.length&&(n={length:o.length,string:o,terminal:i[a]})}else e.utils.obj.isString(t)&&e.utils.str.startsWith(this.inputStream,t)&&n.length<t.length&&(n={length:t.length,string:t,terminal:i[a]});-1===n.length?n=this._getErrorResult():(this.inputStream=this.inputStream.substr(n.length),this.options.notIgnoreSpaces||(this.inputStream=e.utils.str.ltrim(this.inputStream),""===this.inputStream&&(this.inputStream=null)))}return n},n}();e.parser.tableAction={SHIFT:"SHIFT",REDUCE:"REDUCE",ERROR:"ERROR",ACCEPT:"ACCEPT"};e.parser.AutomataLRGeneratorBase=function(){var t=function(t){if(this.options=t,e.utils.obj.defineProperty(this,"grammar"),!(this.grammar instanceof e.data.Grammar))throw new Error("In order to create a new Automata Generator please provide a grammar!")};return t.prototype.expandItem=function(t){for(var n,i=t.getNextItem();i;)n=i.getCurrentSymbol(),n instanceof e.data.NonTerminal&&t.addItems(this._newItemRulesForStateExpansion(i,n),this._getExpansionItemNewItemsOptions()),i=t.getNextItem();return t},t.prototype._getExpansionItemNewItemsOptions=function(){return{hasLookAhead:!1}},t.prototype._newItemRulesForStateExpansion=function(){},t.prototype.generateAutomata=function(t){var n={notValidate:!1,conflictResolvers:[]};t=e.utils.obj.extendInNew(n,t||{});var i=this._generateAutomata();return t.notValidate||this.isAutomataValid(i,t)?i:!1},t.prototype.isAutomataValid=function(t,n){var i={automata:t};return n=e.utils.obj.extend(i,n||{}),!e.utils.obj.any(t.states,function(t){return!this.isStateValid(t,n)},this)},t.prototype.isStateValid=function(){},t.prototype._getConflictResolvers=function(){},t.prototype._generateAutomata=function(){var t=new e.data.State({items:this._getInitialStateItemRules()}),n=new e.data.Automata(this._getNewAutomataOptions(t));
return n.initialStateAccessor(t),this._expandAutomata(n),n},t.prototype._getNewAutomataOptions=function(t){return{states:[this.expandItem(t)]}},t.prototype._getInitialStateItemRules=function(){},t.prototype._expandAutomata=function(t){for(var n=t.getNextState();n;){var i,r=n.getSupportedTransitionSymbols(),a=[];e.utils.obj.each(r,function(r){e.utils.obj.each(r.items,function(t){a.push(t.clone({dotLocationIncrement:1}))});var o=new e.data.State({items:a});this.expandItem(o,t),o.isAcceptanceState=!(1!==o.getOriginalItems().length||o.getOriginalItems()[0].rule.name!==e.data.Grammar.constants.AugmentedRuleName||2!==o.getOriginalItems()[0].dotLocation),i=t.addState(o),n.addTransition(r.symbol,i),a=[]},this),n=t.getNextState()}},t.prototype.generateGOTOTable=function(t){var n={};return e.utils.obj.each(t.states,function(t){n[t.getIdentity()]={},e.utils.obj.each(t.transitions,function(e){n[t.getIdentity()][e.symbol.toString()]=e.state})}),n},t.prototype.generateACTIONTable=function(){},t}(),e.parser.AutomataLR0Generator=function(t){function n(){t.apply(this,arguments)}return e.utils.obj.inherit(n,t),n.prototype._newItemRulesForStateExpansion=function(t,n){return e.data.ItemRule.newFromRules(this.grammar.getRulesFromNonTerminal(n))},n.prototype._getNewAutomataOptions=function(){var e=t.prototype._getNewAutomataOptions.apply(this,arguments);return e.hasLookAhead=!1,e},n.prototype._getInitialStateItemRules=function(){return[new e.data.ItemRule({rule:this.grammar.getRulesFromNonTerminal(this.grammar.startSymbol)[0],lookAhead:[]})]},n.prototype.generateACTIONTable=function(t){var n={};return e.utils.obj.each(t.states,function(t){var i=t.getItems();n[t.getIdentity()]=1===i.length&&i[0].dotLocation===i[0].rule.tail.length?t.isAcceptanceState?{action:e.parser.tableAction.ACCEPT,rule:i[0].rule}:{action:e.parser.tableAction.REDUCE,rule:i[0].rule}:{action:e.parser.tableAction.SHIFT}}),function(t){return function(n){return t[n]||{action:e.parser.tableAction.ERROR}}}(n)},n.prototype.isStateValid=function(t,n){n=e.utils.obj.isObject(n)?n:{},n.conflictResolvers=n.conflictResolvers||[];var i=t.getRecudeItems();return!(i.length!==t.getOriginalItems().length&&i.length>0||i.length>1)},n}(e.parser.AutomataLRGeneratorBase),e.parser.AutomataLALR1Generator=function(t){function n(){t.apply(this,arguments)}return e.utils.obj.inherit(n,t),n.prototype._newItemRulesForStateExpansion=function(t,n){var i=this._getFirstSet(t);return e.data.ItemRule.newFromRules(this.grammar.getRulesFromNonTerminal(n),i)},n.prototype._getExpansionItemNewItemsOptions=function(){return{hasLookAhead:!0}},n.prototype._getFirstSet=function(t){var n=t.rule.tail.slice(t.dotLocation+1),i=[];return n=n.concat(t.lookAhead),e.utils.obj.find(n,function(n){if(n instanceof e.data.NonTerminal)return i=i.concat(this.grammar.firstSetsByHeader[n.name]),i=e.utils.obj.uniq(i,!1,function(t){return t.name}),!n.isNullable;if(n instanceof e.data.Terminal)return i.push(n),!0;if(n.isSpecial&&n.name===e.data.specialSymbol.EOF)return i.push(n),!0;throw new Error("Invalid Item Rule. Impossible calculate first set. Item Rule: "+t.toString())},this),i},n.prototype._getNewAutomataOptions=function(){var e=t.prototype._getNewAutomataOptions.apply(this,arguments);return e.hasLookAhead=!0,e},n.prototype._getInitialStateItemRules=function(){return[new e.data.ItemRule({rule:this.grammar.getRulesFromNonTerminal(this.grammar.startSymbol)[0],lookAhead:[new e.data.Symbol({name:e.data.specialSymbol.EOF,isSpecial:!0})]})]},n.prototype.generateACTIONTable=function(t,n){var i={};return e.utils.obj.each(t.states,function(t){if(i[t.getIdentity()]={},t.isAcceptanceState)i[t.getIdentity()][e.data.specialSymbol.EOF]={action:e.parser.tableAction.ACCEPT,rule:t.getOriginalItems()[0].rule};else{var r={ignoreErrors:!1,considerLookAhead:!0};n=e.utils.obj.extendInNew(r,n||{});var a=this.getShiftReduceItemRuleFromState(t,n);if(!a)throw new Error("Impossible to generate Action Table. The following state is invalid. State: "+t.getIdentity());e.utils.obj.each(a.shiftItems,function(n){i[t.getIdentity()][n.getCurrentSymbol().name]={action:e.parser.tableAction.SHIFT}}),e.utils.obj.each(a.reduceItems,function(n){e.utils.obj.each(n.lookAhead,function(r){i[t.getIdentity()][r.name]={action:e.parser.tableAction.REDUCE,rule:n.rule}})})}},this),function(t){return function(n,i){return t[n]&&i&&i.name&&t[n][i.name]||{action:e.parser.tableAction.ERROR}}}(i)},n.prototype.isStateValid=function(t,n){n=e.utils.obj.isObject(n)?n:{},n.conflictResolvers=n.conflictResolvers||[];var i=t.getRecudeItems(),r=!1,a=e.utils.obj.filter(t.getOriginalItems(),function(t){return!t.isReduce()});if(a.length&&i.length){var o=e.utils.obj.sortBy(e.utils.obj.filter(n.conflictResolvers,function(t){return t.type===e.parser.conflictResolverType.STATE_SHIFTREDUCE}),"order"),s=e.utils.obj.any(a,function(a){var s=a.getCurrentSymbol();return e.utils.obj.find(i,function(i){var u=e.utils.obj.find(i.lookAhead,function(t){return t.name===s.name});return u?(r=e.utils.obj.find(o,function(e){return e.resolve(n.automata,t,a,i)}),!r):!1})});if(s)return!1}if(i.length>1){var u=e.utils.obj.sortBy(e.utils.obj.filter(n.conflictResolvers,function(t){return t.type===e.parser.conflictResolverType.STATE_REDUCEREDUCE}),"order"),l=e.utils.obj.any(i,function(a){return e.utils.obj.find(i,function(i){if(i.getIdentity()===a.getIdentity())return!1;var o=e.utils.obj.find(a.lookAhead,function(t){return e.utils.obj.find(i.lookAhead,function(e){return e.name===t.name})});return o?(r=e.utils.obj.find(u,function(e){return e.resolve(n.automata,t,a,i)}),!r):!1})});if(l)return!1}return!0},n.prototype.getShiftReduceItemRuleFromState=function(t,n){n=e.utils.obj.isObject(n)?n:{},n.conflictResolvers=n.conflictResolvers||[];var i=t.getRecudeItems(),r=e.utils.obj.filter(t.getOriginalItems(),function(t){return!t.isReduce()}),a=!!n.ignoreErrors,o={shiftItems:[],reduceItems:[]},s=!1;if(i=e.utils.obj.map(i,function(t){return t.clone()}),r.length){var u=e.utils.obj.sortBy(e.utils.obj.filter(n.conflictResolvers,function(t){return t.type===e.parser.conflictResolverType.STATE_SHIFTREDUCE}),"order"),l=e.utils.obj.any(r,function(r){var l=r.getCurrentSymbol(),c=e.utils.obj.find(i,function(i){var a=e.utils.obj.find(i.lookAhead,function(t){return t.name===l.name});if(a){var o;if(s=e.utils.obj.find(u,function(e){return o=e.resolve(n.automata,t,r,i)}),s&&o.action===e.parser.tableAction.SHIFT){var c=e.utils.obj.indexOf(i.lookAhead,a);i.lookAhead.splice(c,1)}return!s}return!1});return!c||a?(o.shiftItems.push(r),!1):!0});if(l)return!1}if(i.length){var c=e.utils.obj.sortBy(e.utils.obj.filter(n.conflictResolvers,function(t){return t.type===e.parser.conflictResolverType.STATE_REDUCEREDUCE}),"order"),d=e.utils.obj.any(i,function(r){var u=e.utils.obj.find(i,function(i){if(i.getIdentity()===r.getIdentity())return!1;var a=e.utils.obj.find(r.lookAhead,function(t){return e.utils.obj.find(i.lookAhead,function(e){return e.name===t.name})});return a?(s=e.utils.obj.find(c,function(e){return e.resolve(n.automata,t,r,i)}),!s):!1});return!u||a?(o.reduceItems.push(r),!1):!0});if(d)return!1}return o},n}(e.parser.AutomataLRGeneratorBase);{var u=e.parser.conflictResolverType={STATE_SHIFTREDUCE:"STATE_SHIFTREDUCE",STATE_REDUCEREDUCE:"STATE_REDUCEREDUCE"},l=e.parser.ConflictResolver=function(){var t=function(t){this.options=t||{},e.utils.obj.defineProperty(this,"name"),e.utils.obj.defineProperty(this,"type"),e.utils.obj.defineProperty(this,"order"),e.utils.obj.defineProperty(this,"resolveFnc"),this.type=this.type||u.STATE_SHIFTREDUCE,this.order=this.order||9999};return t.prototype.resolve=function(t,n,i,r){return e.utils.obj.isFunction(this.resolveFnc)?this.resolveFnc(t,n,i,r):!1},t.getDefaultResolvers=function(){return[new l({name:"precedence_resolver",type:u.STATE_SHIFTREDUCE,order:10,resolveFnc:function(t,n,i,r){return e.utils.obj.isNumber(i.rule.precendence)||e.utils.obj.isNumber(r.rule.precendence)?(i.rule.precendence=e.utils.obj.isNumber(i.rule.precendence)?i.rule.precendence:0,r.rule.precendence=e.utils.obj.isNumber(r.rule.precendence)?r.rule.precendence:0,i.rule.precendence>r.rule.precendence?{itemRule:i,action:e.parser.tableAction.SHIFT}:i.rule.precendence<r.rule.precendence?{itemRule:r,action:e.parser.tableAction.REDUCE}:!1):!1}}),new l({name:"associativity_resolver",type:u.STATE_SHIFTREDUCE,order:20,resolveFnc:function(t,n,i,r){var a=i.getCurrentSymbol();return a.assoc===e.data.associativity.RIGHT?{action:e.parser.tableAction.SHIFT,itemRule:i}:a.assoc===e.data.associativity.LEFT?{action:e.parser.tableAction.REDUCE,itemRule:r}:!1}})]},t}();e.parser.Parser=function(){var t=function(t){if(this.options=t,e.utils.obj.defineProperty(this,"gotoTable"),e.utils.obj.defineProperty(this,"grammar"),e.utils.obj.defineProperty(this,"actionTable"),e.utils.obj.defineProperty(this,"initialState"),e.utils.obj.defineProperty(this,"stack"),e.utils.obj.defineProperty(this,"currentInput"),!this.gotoTable)throw new Error("Invalid initialization values for a Parser, please provide a GOTO Table");if(!this.actionTable)throw new Error("Invalid initialization values for a Parser, please provide a Action Table");if(!this.grammar)throw new Error("Invalid initialization values for a Parser, please provide a Grammar");if(!this.initialState)throw new Error("Invalid initialization values for a Parser, please provide a Initial State");this.stack=this.stack||[]};return t.prototype.parse=function(t){var n=new e.data.StackItem({state:this.initialState});return this.currentInput=t.getNext(),this.currentInput.ERROR?!1:(this.stack.push(n),this._parse(t))},t.prototype._parse=function(t){for(var n,i,r=this.stack[this.stack.length-1];;){if(i=this.actionTable(r.state.getIdentity(),this.currentInput.terminal),i.action===e.parser.tableAction.ERROR)return!1;if(i.action===e.parser.tableAction.SHIFT)r.symbol=this.currentInput.terminal,r.currentValue=this.currentInput.string,r.stringValue=this.currentInput.string,this.currentInput=t.getNext();else if(i.action===e.parser.tableAction.REDUCE)r=this._reduce(i);else if(i.action===e.parser.tableAction.ACCEPT)return r=this._reduce(i),r.AST.nodes[0];if(n=this.gotoTable[r.state.getIdentity()][r.symbol],!n)return!1;this.stack.push(new e.data.StackItem({state:n})),r=this.stack[this.stack.length-1]}},t.prototype._reduce=function(t){var n,i,r,a={},o=t.rule,s=1===o.tail.length&&o.tail[0].name===e.data.specialSymbol.EMPTY,u=this.stack[this.stack.length-1];return r=s?[]:this.stack.slice(-1*(o.tail.length+1),this.stack.length-1),a.values=e.utils.obj.map(r,function(t){return t.currentValue||t.symbol}),a.rule=o,this.stack=s?this.stack:this.stack.slice(0,-1*o.tail.length),u=this.stack[this.stack.length-1],u.symbol=o.head,u.currentValue=e.utils.obj.isFunction(o.reduceFunc)?o.reduceFunc.call(this,a):u.symbol,i=e.utils.obj.map(r,function(t){return t.AST||t.stringValue}),n=new e.data.ASTNode({nodes:i,rule:o,symbol:o.head,stringValue:u.stringValue,currentValue:u.currentValue}),u.AST=n,u},t}(),e.parser.parserCreator=function(){var t=function(){};return t.create=function(t){t=e.utils.obj.extend({},{automataGenerator:e.parser.AutomataLALR1Generator},t||{});var n=t.grammar,i=new t.automataGenerator({grammar:n}),r=i.generateAutomata({conflictResolvers:e.parser.ConflictResolver.getDefaultResolvers()}),a=i.generateGOTOTable(r),o=i.generateACTIONTable(r,{conflictResolvers:e.parser.ConflictResolver.getDefaultResolvers(),ignoreErrors:!1}),s=new e.lexer.Lexer({grammar:n,stream:t.strInput}),u=new e.parser.Parser({gotoTable:a,grammar:n,actionTable:o,initialState:r.initialStateAccessor()});return{parser:u,lexer:s}},t}()}return e});
//# sourceMappingURL=kappa.min.js.map